package handlers

import (
	"context"
	"strconv"
	"strings"

	"github.com/iamwavecut/ngbot/internal/adapters"
	"github.com/iamwavecut/ngbot/internal/adapters/llm"
	"github.com/iamwavecut/tool"
	"github.com/pkg/errors"
	log "github.com/sirupsen/logrus"
)

type spamDetector struct {
	llm    adapters.LLM
	logger *log.Entry
}

type example struct {
	Message  string `json:"message"`
	Response int    `json:"response"`
}

var examples = []example{
	{
		Message:  "Hello, how are you?",
		Response: 0,
	},
	{Message: "Hello, how are you?", Response: 0},
	{Message: "–•–æ—á–µ—à—å –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —É–¥–∞–ª—ë–Ω–∫–µ –Ω–æ –Ω–µ –∑–Ω–∞–µ—à—å –∫–∞–∫? –ù–∞–ø–∏—à–∏ –º–Ω–µ –∏ —è —Ç–µ–±–µ –≤—Å—ë —Ä–∞—Å—Å–∫–∞–∂—É, –æ—Ç 18 –ª–µ—Ç. –∂–¥—É –≤—Å–µ—Ö –∂–µ–ª–∞—é—â–∏—Ö –≤ –ª—Å.", Response: 1},
	{Message: "–ù—É–∂–Ω—ã –ª—é–¥–∏! –°—Ç–∞–±–∏–ª—å–Ω–Ω—ã–π –¥–æ—Ö–æ–¥, –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é, –Ω–∞ —É–¥–∞–ª—ë–Ω–∫–µ, –æ—Ç 18 –ª–µ—Ç, –ø–∏—à–∏—Ç–µ –≤ –ª—Å.", Response: 1},
	{Message: "–ò—â—É –ª—é–¥e–π, –∑–∞–∏–Ω—Çe—Äe—Å–æ–≤–∞–Ω–Ω—ã—Ö –≤ —Öo—Äo—à–µ–º –¥–æ–ø.–¥–æ—Ö–æ–¥–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–∫–µ. –ù–µ –ø–æ–ª–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å, –æ—Ç 21. –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –ø–∏—à–∏—Ç–µ –≤ –õ–°", Response: 1},
	{Message: "10000—Ö –û—Ä—É—É—É –≤ –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–∞–ª –∏ —Ç–∞–∫–æ–≥–æ –Ω–µ —Ä–∞–∑—É –Ω–µ –±—ã–ª–æ, –ø—Ä–æ—Å—Ç–æ –∫–∞–ø–µ—Ü  –∞ —Ç–∞–∫–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ???? ", Response: 1},
	{Message: `ü•á–ü–µ—Ä–≤–∞—è –∏–≥—Ä–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤ Telegram

https://t.me/jetton?start=cdyrsJsbvYy
`, Response: 1},
	{Message: "–ù–∞–±–∏—Ä–∞—é –∫–æ–º–∞–Ω–¥—É –Ω—É–∂–Ω–æ 2-3 —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É –∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø–∫ –æ—Ç  –¥–µ—Å—è—Ç —Ç—ã—Å—è—á –≤ –¥–µ–Ω—å  –ø–∏—à–∏—Ç–µ + –≤ –ª—Å", Response: 1},
	{Message: `üíé –ü·¥©·¥è·¥á·¥ã·¥õ TONCOIN,  ô—ã·¥®—É·¥Ñ·¥õ–∏·¥ß ·¥Ñ ô·¥è·¥á·¥¶·¥è ·¥ã·¥Ä…ú–∏–Ω·¥è –±·¥è·¥õ·¥Ä  ô ·¥õ·¥á·¥ß·¥á·¥¶·¥©·¥Ä ç ç·¥á

üëë –°·¥Ä ç—ã·¥á  ô—ã·¥Ñ·¥è·¥ã–∏·¥á …Ø·¥Ä–Ω·¥Ñ—ã  ô—ã–∏·¥¶·¥©—ã…Ø·¥Ä 
‚è≥ –ú·¥è ç·¥á–Ω·¥õ·¥Ä·¥ß—å–Ω—ã–π  ô ô·¥è–¥ –∏  ô—ã ô·¥è–¥
üé≤ –ù·¥á ·¥õ·¥©·¥á–±—É·¥á·¥õ ·¥©·¥á·¥¶–∏·¥Ñ·¥õ·¥©·¥Ä—Ü–∏–∏
üèÜ –í·¥Ñ·¥á ·¥ß—É—á…Ø–∏·¥á ·¥®·¥©·¥è ô·¥Ä–π–¥·¥á·¥©—ã –∏ –∏·¥¶·¥©—ã 

üçã –ó·¥Ä–±·¥©·¥Ä·¥õ—å 1000 USDT üëá

t.me/slotsTON_BOT?start=cdyoNKvXn75`, Response: 1},
	{Message: "–≠—Ä–æ—Ç–∏–∫–∞", Response: 0},
	{Message: "–û–ª–µ–≥–∏–∫)))", Response: 0},
	{Message: "–ê–≤–∞–Ω—Ç—é—Ä–∞!", Response: 0},
	{Message: "–Ø –≤—Å—ë –ø–æ–Ω—è–ª, —Å–ø–∞—Å–∏–±–æ!", Response: 0},
	{Message: "–≠—Ç–æ –Ω–µ —Ç–∞–∫", Response: 0},
	{Message: "–ù–µ —Å–æ—á—Ç–∏—Ç–µ –∑–∞ —Å–ø–∞–º, —Ö–æ—á—É –ø–æ—Ä–µ–∫–ª–∞–º–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π –∫–∞–Ω–∞–ª", Response: 0},
	{Message: "–ù–µ—Ç", Response: 0},
	{Message: "???", Response: 0},
	{Message: "...", Response: 0},
	{Message: "–î–∞", Response: 0},
	{Message: "–ò—â—É –ª—é–¥–µ–π, –≤–æ–∑—å–º—É 2-3 —á–µ–ª–æ–≤–µ–∫–∞ 18+ –£–¥–∞–ª–µ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å.–û—Ç 250$  –≤  –¥–µ–Ω—å.–ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ: –ü–∏—à–∏—Ç–µ + –≤ –ª—Å", Response: 1},
	{Message: "–ù—É–∂–Ω—ã –ª—é–¥–∏, –∑–∞–Ω—è—Ç–æ—Å—Ç—å –Ω–∞ —É–¥–∞–ª—ë–Ω–∫–µ", Response: 1},
	{Message: "3–¥pa–≤c—Ç–≤y–π—Çe,–í–µ–¥—É –ø–æ–∏—Å–∫ –øa—Ä—Ç–Ω—ë—Ä–æ–≤ –¥–ª—è —Åo—Ç—Ä—É–¥–Ωu—á–µ—Å—Ç–≤–∞ ,—Å–≤o–±o–¥–Ω—ã–π –≥pa—Ñ–∏–∫ ,–øpu—è—Ç–Ω—ã–π –∑apa–±o—Çok e–∂–µ–Ωe–¥–µ–ª—å–Ω–æ. Ec–ª–∏ –∏–Ω—Çepec—Ée—Ç –øo–¥po–±–Ωa—è –∏–Ω—Ñop–ºa—Ü–∏—è –ø–∏—àu—Ç–µ.", Response: 1},
	{Message: `üíöüíöüíöüíöüíöüíöüíöüíö
–ò—ây –Ωa o–±y—áe–Ω–∏e –ª—é–¥e–π c —Üe–ª—å—é –∑apa–±o—Ç–∫a. üíº
*‚É£Ha–øpa–≤–ªe–Ω–∏e: Crypto, –¢ec—Ç–Ωe—Ç—ã, A–∏p–¥po–ø—ã.
*‚É£–üo –≤pe–ºe–Ω–∏ –≤ cy—Ç–∫–∏ 1-2 —áaca, –ºo–∂–Ωo pa–±o—Ça—Ç—å co c–ºap—Ç—Ño–Ωa. ü§ù
*‚É£–îoxo–¥–Ωoc—Ç—å —á–∏c—Ça—è –≤ –¥e–Ω—å pa–≤–Ω—èe—Çc—è o—Ç 7-9 –øpo—Üe–Ω—Ço–≤.
*‚É£–ëEC–ü–õA–¢HOE O–ë–£–ßEH–òE, –ºo–π –∏–Ω—Çepec –øpo—Üe–Ω—Ç o—Ç –∑apa–±o—Ç–∫a. üí∂
Ec–ª–∏ –∑a–∏–Ω—Çepeco–≤a–ªo –ø–∏—à–∏—Çe –Ωa –ºo–π a–∫–∫ >>> @Alex51826.`, Response: 1},
	{Message: "–ò—â—É –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Å—Å–∏–≤–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏, –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç + —Ö–æ—Ä–æ—à–∏–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–æ–ø.–¥–æ—Ö–æ–¥. –ü–∏—à–∏—Ç–µ + –≤ –ª–∏—á–Ω—ã–µ", Response: 1},
	{Message: "–£–¥–∞–ª—ë–Ω–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å, —Å —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∏–±—ã–ª—å—é 350 –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ –¥–µ–Ω—å.1-2 —á–∞—Å–∞ –≤ –¥–µ–Ω—å. –°—Ç–∞–≤—å –ø–ª—é—Å –º–Ω–µ –≤ –ª–∏—á–Ω—ã–µ —Å–º—Å.", Response: 1},
	{Message: "–ü—Ä–∏–±—ã–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ, –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ(—É–¥–∞–ª–µ–Ω–Ω–æ) , –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω.–ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–º—Å  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!", Response: 1},
	{Message: "–ó–¥—Äa–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –≤–∞–º –ø—Äe–¥–ª–æ–∂–∏—Ç—å –≤a—Ä–∏–∞–Ω—Ç –øa—Å—Å–∏–≤–Ω–æ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∫–∞.–£–¥a–ª–µ–Ω–∫–∞.–û–±—É—á–µ–Ω–∏–µ –±e—Å–ø–ª–∞—Ç–Ω–æ–µ, –æ—Ç –≤–∞—Å —Ç—Äe–±—Ée—Ç—Å—è —Ç–æ–ª—å–∫–æ –øa—Äa —áa—Å–æ–≤ —Å–≤o–±o–¥–Ωo–≥o –≤—Ä–µ–ºe–Ω–∏ –∏ —Çe–ªe—Ñ–æ–Ω –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä. –ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –Ω–∞–ø–∏—à–∏ –º–Ω–µ.", Response: 1},
	{Message: "–ò—â—É –ª—é–¥–µ–π, –≤–æ–∑—å–º—É 3 —á–µ–ª–æ–≤–µ–∫–∞ –æ—Ç 20 –ª–µ—Ç. –£–¥–∞–ª–µ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –û—Ç 250 –¥o–ª–ª–∞—Ä–æ–≤ –≤ –¥–µ–Ω—å. –ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–∏—à–∏—Ç–µ –ø–ª—é—Å –≤ –ª–∏—á–∫—É", Response: 1},
	{Message: "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä! –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å) —è –±—ã —Ç–æ–∂–µ —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º —É–∑–Ω–∞–ª–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é", Response: 0},
	{Message: `–Ø–Ω—Ç–∞—Ä–∏–∫ ‚Äî –∫–æ—à–∫–∞-–º–∞—Ä—Ç—ã—à–∫–∞, —Å–≥—É—Å—Ç–æ–∫ —ç–Ω–µ—Ä–≥–∏–∏ —Å –æ—Ç–ª–∏—á–Ω—ã–º —É—Ä—á–∞—Ç–µ–ª–µ–º ‚ù§Ô∏è‚Äçüî•

üß° –ò—â–µ—Ç —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä–æ–º—É –º—É—Ä—á–∞—Ç—å
üß° –û–∫–æ–ª–æ 11 –º–µ—Å—è—Ü–µ–≤
üß° –°—Ç–µ—Ä–∏–ª–∏–∑–æ–≤–∞–Ω–∞. –û–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –æ—Ç –ø–∞—Ä–∞–∑–∏—Ç–æ–≤. –í–ø–µ—Ä–µ–¥–∏ –≤–∞–∫—Ü–∏–Ω–∞—Ü–∏—è, —á–∏–ø –∏ –ø–∞—Å–ø–æ—Ä—Ç
üß° C –Ω–µ–Ω–∞–≤—è–∑—á–∏–≤—ã–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º —Å—É–¥—å–±—ã üôè
üá¨üá™ –ì–æ—Ç–æ–≤–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ –ª—é–±–æ–π —É–≥–æ–ª–æ–∫ –ì—Ä—É–∑–∏–∏, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –¥–∞–ª—å—à–µ

–¢–µ–ª–µ–≥—Ä–∞–º nervnyi_komok
WhatsApp +999 599 099 567`, Response: 0},
	{Message: "–ï—Å—Ç—å –Ω–µ—Å–ª–æ–∂–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å! –†–∞–±–æ—Ç–∞–µ–º –∏–∑ –¥–æ–º—É. –î–æ—Ö–æ–¥ –æ—Ç 450 –¥–æ–ª–ª. –≤ –¥–µ–Ω—å. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—Ç–æ—Ä–∞-–¥–≤–∞ —á–∞—Å–∞ –≤ –¥–µ–Ω—å. –°—Ç–∞–≤—å—Ç–µ ¬´+¬ª –≤ –ª.—Å.", Response: 1},
	{Message: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ. –ï—Å—Ç—å –≤o–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑a—Ä–∞–±–æ—Ç–∫–∞.–°—Ça–±–∏–ª—å–Ω–æ—Å—Ç—å –≤ –≤–∏–¥–µ 45 000 —Äy–±–ª–µ–π –≤ –Ω–µ–¥–µ–ª—é. –û–ø—ã—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –í—Å–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —É –º–µ–Ω—è –≤ –ª–∏—á–∫–µ", Response: 1},
	{Message: "–£–¥–∞–ª—ë–Ω–Ω–∞—è –∑a–Ω—è—Ç–æ—Å—Ç—å, —Å —Ö–æ—Äo—à–µ–π –ø—Ä–∏–±—ã–ª—å—é 550 –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ –¥–µ–Ω—å. –¥–≤–∞ —á–∞—Å–∞ –≤ –¥–µ–Ω—å. –°—Ç–∞–≤—å –ø–ª—é—Å –º–Ω–µ –≤ –ª–∏—á–Ω—ã–µ", Response: 1},
	{Message: `üíöüíöüíöüíöüíöüíöüíöüíö
–ò—ây –Ωa o–±y—áe–Ω–∏e –ª—é–¥e–π c —Üe–ª—å—é –∑apa–±o—Ç–∫a. üíº
*‚É£Ha–øpa–≤–ªe–Ω–∏e: Crypto, –¢ec—Ç–Ωe—Ç—ã, A–∏p–¥po–ø—ã.
*‚É£–üo –≤pe–ºe–Ω–∏ –≤ cy—Ç–∫–∏ 1-2 —áaca, –ºo–∂–Ωo pa–±o—Ça—Ç—å co c–ºap—Ç—Ño–Ωa. ü§ù
*‚É£–îoxo–¥–Ωoc—Ç—å —á–∏c—Ça—è –≤ –¥e–Ω—å pa–≤–Ω—èe—Çc—è o—Ç 7-9 –øpo—Üe–Ω—Ço–≤.
*‚É£–ëEC–ü–õA–¢HOE O–ë–£–ßEH–òE, –ºo–π –∏–Ω—Çepec –øpo—Üe–Ω—Ç o—Ç –∑apa–±o—Ç–∫a. üí∂
Ec–ª–∏ –∑a–∏–Ω—Çepeco–≤a–ªo –ø–∏—àu—Ç–µ –Ωa –ºo–π a–∫–∫ >>> @Alex51826.`, Response: 1},
	{Message: "–ù—É–∂–Ω—ã –ª—é–¥–∏ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞. –•–æ—Ä–æ—à–∞—è –ø—Ä–∏–±—ã–ª—å –≤ –Ω–µ–¥–µ–ª—é, –æ—Ç —Ç—ã—Å—è—á–∏ –¥–æ–ª–ª–∞—Ä–æ–≤ –∏ –≤—ã—à–µ. –£–¥–∞–ª–µ–Ω–Ω–æ. –ó–∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏ –ø–∏—à–∏—Ç–µ –º–Ω–µ –ø–ª—é—Å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç –¥–≤–∞–¥—Ü–∞—Ç–∏ –ª–µ—Ç", Response: 1},
	{Message: `–ü—Ä–µ–¥–ª–∞–≥–∞—é —É–¥–∞–ª–µ–Ω–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –æ—Ç $2500 –≤ –º–µ—Å—è—Ü.  

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:  
‚Äì –ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä  
‚Äì –ù–µ–º–Ω–æ–≥–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∂–µ–ª–∞–Ω–∏—è
‚Äì –ë—ã—Å—Ç—Ä–∞—è –æ–±—É—á–∞–µ–º–æ—Å—Ç—å  

–ó–∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏ ‚Äì –ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è!`, Response: 1},
	{Message: "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä. –ó–∞–≤—Ç—Ä–∞ –≤–µ—á–µ—Ä–æ–º –µ–¥—É –∏–∑ –ö–æ–±—É–ª–µ—Ç–∏ –≤ –ë—Ä–µ—Å—Ç —Å –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –≤ –ú–∏–Ω—Å–∫–µ –≤ 18:00. –í–æ–∑—å–º—É –Ω–µ–±–æ–ª—å—à–∏–µ –ø–µ—Ä–µ–¥–∞—á–∫–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã. –ü–∏—Å–∞—Ç—å –≤ –ª—Å", Response: 0},
	{Message: "https://anywebsite.com/in/p/1234567890", Response: 0},
	{Message: `He–≤epo—è—Ç–Ω—ã–π –¥e–Ωe–∂–Ω—ã–π –øo—Ço–∫ –∫a–∂–¥—ã–π –¥e–Ω—å.
 - –øpo—Ñu—Ç o—Ç 3OO USD –≤ –¥e–Ω—å
 - –Ωo–≤a—è c—Çopo–Ωa y—áac—Çu—è
C—Çu–ºy–ªupo–≤a–Ω–Ω—ã–º –øuca—Ç—å "+" –≤ c–ºc`, Response: 1},
	{Message: "·¥®·¥©–∏ ô·¥á·¥õ!–∏—â—É ·¥ß—é–¥·¥á–π –¥·¥ß—è ·¥®·¥Äcc–∏ ô–Ω–æ·¥¶o –∑·¥Ä·¥©·¥Ä–±o·¥õ·¥ã·¥Ä. ·¥®·¥ß—éc—ã:xo·¥©o…Ø–∏–π –¥oxo–¥, —É–¥·¥Ä·¥ß—ë–Ω–Ω—ã–π …∏o·¥© ç·¥Ä·¥õ, ·¥®·¥©o·¥Ñ·¥õ–æ·¥õ·¥Ä. ·¥á·¥Ñ·¥ß–∏ –∏–Ω·¥õ·¥á·¥©·¥á·¥Ñ–Ω–æ, –Ω·¥Ä·¥®–∏…Ø–∏·¥õ·¥á +  ô ·¥ß.c.", Response: 1},
	{Message: "–î–ª—è —Ç–µ—Ö, —É –∫–æ–≥–æ —Ü–µ–ª—å –ø–æ–ª—É—á–∞—Ç—å –æ—Ç 1000 –¥–æ–ª–ª–∞p–æ–≤, –µ—Å—Ç—å –Ωa–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É—é—â–µ–µ –Ω–∞–ª–∏—á–∏–µ –∑–Ω–∞–Ω–∏–π –∏ o–ø—ã—Ç–∞. –ù—É–∂–Ω–æ –¥–≤–∞ —á–∞—Å–∞ –≤ –¥–µ–Ω—å –∏ –Ω–∞–ª–∏—á–∏–µ –∞–º–±–∏—Ü–∏–π. –û—Ç 21 –¥–æ 65 –ª–µ—Ç.", Response: 1},
	{Message: "–ópa–≤c—Ç–≤y–π—Çe.–ùy–∂–Ω—ã –¥–≤–∞ —Ç—Ä–∏ —áe–ªo–≤e–∫a.–£–¥–∞–ª–µ–Ω–Ω–∞—è –†–∞–±–æ—Ç–∞ O—Ç 200 –¥–æ–ª–ª –≤ –¥e–Ω—å.–óa –øo–¥po–±–Ωoc—Ç—è–º–∏ –ø–∏—à–∏ –ø–ª—é—Å –≤ –ª—Å", Response: 1},
	{Message: `–î–æ–±—Ä—ã–π –¥–µ–Ω—å!
–†–µ–∫–æ–º–µ–Ω–¥—É—é "–æ—Ç–∫—Ä—ã–≤–∞—à–∫—É" –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, –¥–∞ –∏ —Å –ø–æ–¥–±–æ—Ä–æ–º "–ø–æ–¥ –∫–ª—é—á" —Å–ø—Ä–∞–≤–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ 89111447979`, Response: 1},
	{Message: "–í–µ–¥—É –øo–∏—Å–∫ –ª—é–¥–µ–π –¥–ª—è —Ö–æ—Äo—à–µ–≥–æ –¥–æx–æ–¥–∞ –Ωa –¥–∏c—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–º —Ñ–æ—Ä–ºa—Ç–µ, –æ—Ç —Ç—ã—Å—è—á–∏ –¥–æ–ª–ª—Ä–æ–≤ –≤ –Ω–µ–¥–µ–ª—é, –¥–µ—Ç–∞–ª–∏ –≤ –ª–∏—á–Ω—ã—Ö —Åo–æ–±—â–µ–Ω–∏—è—Ö", Response: 1},
	{Message: "–ù—É–∂–Ω—ã –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –ª—é–¥–∏ –≤ –∫–æ–º–∞–Ω–¥—É. –í–æ–∑–º–æ–∂–µ–Ω –¥–æ—Ö–æ–¥ –æ—Ç 900 –¥–æ–ª–ª–∞—Ä–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é,–ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.–ü–∏—à–∏—Ç–µ –º–Ω–µ + –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è", Response: 1},
	{Message: `üçì –°–õ–ò–¢–´–ï –ò–ù–¢–ò–ú –§–û–¢–û –õ–Æ–ë–û–ô –î–ï–í–£–®–ö–ò –í –≠–¢–û–ú –ë–û–¢–ï

üçë –ü–ï–†–ï–•–û–î–ò –ò –£–ë–ï–î–ò–°–¨ ‚¨áÔ∏è

https://t.me/shop_6o11rU_bot?start=2521`, Response: 1},
	{Message: `–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç –Ω–∞ –£–î–ê–õ–ï–ù–ö–£ —Å —Ö–æ—Ä–æ—à–∏–º –¥–æ—Ö–æ–¥–æ–º .

–ó–∞–Ω—è—Ç–æ—Å—Ç—å 1-2 —á–∞—Å–∞ –≤ –¥–µ–Ω—å, –æ—Ç 18 –ª–µ—Ç


 –ü–∏—à–∏—Ç–µ –≤ –õ–° –∑–∞ –¥–µ—Ç–∞–ª—è–º–∏!`, Response: 1},
	{Message: "O—Ç–∫p—ã—Ç –Ωa–±op –≤ –∫o–ºa–Ω–¥y, –≤ –Ωo–≤o–º o–Ω–ªa–π–Ω –øpoe–∫—Çe. E–∂e–¥–Ωe–≤–Ω—ã–π –¥oxo–¥ –±o–ªee –ó4O –ïUR. –ñe–ªa—é—âux –∂–¥y –≤ –ªu—á–Ωo–º —áa—Çe.", Response: 1},
	{Message: `–üpu–≤–µ—Ç—Å—Ç–≤y—é, ec—Ç—å 4 c–≤o–±o–¥–Ω—ãx –ºec—Ç–∞ –≤ pa–∑–≤u–≤–∞—é—âeec—è –∫o–º—å—é–Ωu—Çu.
–üpe–¥oc—Ça–≤u–º –≤o–∑–ºo–∂–Ωoc—Ç—å –øo–ªy—áa—Ç—å c–≤—ã—àe 2–û–û–û USd –≤ –Ωe–¥e–ª—é.
–üuca—Ç—å —Ço–ª—å–∫o –∑au–Ω—Çepeco–≤a–Ω–Ω—ã–º.`, Response: 1},
	{Message: `–ü—Ä–∏–≤–µ—Ç, –Ω—É–∂–Ω—ã –ª—é–¥–∏, –æ–ø–ª–∞—Ç–∞ –¥–æ—Å—Ç–æ–π–Ω–∞—è, –±–µ—Ä–µ–º –±–µ–∑ –æ–ø—ã—Ç–∞, –∑–∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏ –≤ –ª—Å
*–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–µ–Ω —Ç–µ–ª–µ—Ñ–æ–Ω
*2-3 —á–∞—Å–∞ –≤—Ä–µ–º–µ–Ω–∏`, Response: 1},
	{Message: "–ù–æ—á—å—é —Å 12 –Ω–∞ 13 –Ω–æ—è–±—Ä—è –µ–¥—É –∏–∑ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ –ö—É—Ç–∞–∏—Å–∏ –¥–æ –ë–∞—Ç—É–º–∏. –í–æ–∑—å–º—É –∑–∞ –±–µ–Ω–∑–∏–Ω. –ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–∏—à–∏—Ç–µ –≤ –õ–°.", Response: 0},
	{Message: "–ö—É–ø–∏—Ç–µ –≤ –∑—É–º–µ—Ä–µ, —Å—ä–µ–∑–¥–∏—Ç–µ –≤ —Å–∞—Ä–ø–∏, tax free, –∑–∞–±–µ—Ä–∏—Ç–µ 11% —Å –ø–æ–∫—É–ø–∫–∏ –∏ –≤—É–∞–ª—è, –Ω–æ—Ä–º —Ü–µ–Ω–∞", Response: 0},
	{Message: "–ó–¥pa–≤c—Ç–≤y–π—Çe.–ùy–∂–Ω—ã –¥–≤a —Ç—Ä–∏ —áe–ªo–≤e–∫a (–£–¥a–ªe–Ω–Ωa—è c—Ñ–µpa) O—Ç 570 $/–Ω–µ–¥–µ–ª—é.–óa –øo–¥po–±–Ωoc—Ç—è–º–∏ –ø–∏—à–∏ –ø–ª—éc –≤ –ªc", Response: 1},
	{Message: "–í—Å–µ–º –∫o–º—É –∏–Ω—Ç–µ—Ä–µc–Ω–æ –∏–ºe—Ç—å x–æ—Ä–æ—à–∏–π c—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æx–æ–¥ –Ω–∞ y–¥–∞–ª–µ–Ω–∫–µ c–æ —Å–≤–æ–±–æ–¥–Ω–æ–π –∑–∞–Ω—è—Ç–æ—Å—Ç—å—é , –∂–¥y –≤ –ªc.", Response: 1},
	{Message: "–•–∞–π. –£—Å—Ç–∞–ª–∏ –æ—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞p–∞–±–æ—Ç–∫–∞ –∏ –ø—É—Å—Ç—ã—Ö –æ–±–µ—â–∞–Ω–∏–π? –î–∞–≤–∞–π—Ç–µ –ª—É—á—à–µ —Äa–±–æ—Ç–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑y–ª—å—Ç–∞—Ç–∞–º–∏. –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å—Ç–∞–±–∏–ª—å–Ωo–µ –Ωa–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≥–¥–µ –º–æ–∂–Ω–æ –ø–æ–ªy—á–∞—Ç—å –æ—Ç 800 –¥o–ª–ª–∞—Ä–æ–≤ –≤ –Ω–µ–¥–µ–ª—é —Å –æ—Ç–ª–∏—á–Ω–æ–π –ø–µ—Äc–ø–µ–∫—Ç–∏–≤–æ–π —Ä–æ—Å—Ça. –ü–∏—à–∏—Ç–µ –ø–ª—é—Å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —è –¥–∞–º –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ", Response: 1},
}

func NewSpamDetector(llm adapters.LLM, logger *log.Entry) *spamDetector {
	return &spamDetector{
		llm:    llm,
		logger: logger,
	}
}

func (d *spamDetector) IsSpam(ctx context.Context, message string) (*bool, error) {

	messagesChain := []llm.ChatCompletionMessage{
		{
			Role:    "system",
			Content: spamDetectionPrompt,
		},
	}

	for _, example := range examples {
		messagesChain = append(messagesChain, llm.ChatCompletionMessage{
			Role:    "user",
			Content: example.Message,
		})
		messagesChain = append(messagesChain, llm.ChatCompletionMessage{
			Role:    "assistant",
			Content: strconv.Itoa(example.Response),
		})
	}

	resp, err := d.llm.ChatCompletion(
		ctx,
		messagesChain,
	)

	if err != nil {
		return nil, errors.Wrap(err, "failed to check spam with LLM")
	}

	if len(resp.Choices) == 0 {
		return nil, errors.New("no response from LLM")
	}

	if len(resp.Choices) == 0 || resp.Choices[0].Message.Content == "" {
		return nil, errors.New("empty response from LLM")
	}
	choice := resp.Choices[0].Message.Content
	cleanedChoice := strings.Map(func(r rune) rune {
		if r >= '0' && r <= '1' {
			return r
		}
		return -1
	}, choice)

	if cleanedChoice == "1" {
		return tool.Ptr(true), nil
	} else if cleanedChoice == "0" {
		return tool.Ptr(false), nil
	}

	return nil, errors.New("unknown response from LLM: " + cleanedChoice + " (" + choice + ")")
}

const spamDetectionPrompt = `–¢—ã –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–ø–∞–º–∞, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —è–∑—ã–∫–∞—Ö. –û—Ü–µ–Ω–∏ –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ–ø—Ä–µ–¥–µ–ª–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ø–∞–º–æ–º –∏–ª–∏ –Ω–µ—Ç.

–ü—Ä–∏–∑–Ω–∞–∫–∏ —Å–ø–∞–º–∞:
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã/–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –±–µ–∑ –¥–µ—Ç–∞–ª–µ–π –æ —Ä–∞–±–æ—Ç–µ –∏ —É—Å–ª–æ–≤–∏—è—Ö, —Å –ø—Ä–æ—Å—å–±–æ–π –Ω–∞–ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
- –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã/–∑–∞—Ä–∞–±–æ—Ç–∫–∞, —Å –ø—Ä–æ—Å—å–±–æ–π –Ω–∞–ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—Ä–µ—Ç—å–µ–≥–æ –ª–∏—Ü–∞ –∏–ª–∏ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
- –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∞–∑–∞—Ä—Ç–Ω—ã—Ö –∏–≥—Ä/—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å—Ö–µ–º.
- –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–µ–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∏ "–ø—Ä–æ–±–∏–≤–∞–Ω–∏—è" –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∞–π—Ç—ã —Å —Ç–∞–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.
- –í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ —Å —è–≤–Ω—ã–º–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏ –∏ GET –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤—Ä–æ–¥–µ "?ref=", "/ref", "invite" –∏ —Ç.–ø.
- –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ —Å–º–µ—à–∞–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö, –Ω–æ –≤–Ω—É—Ç—Ä–∏ —Å–ª–æ–≤ –µ—Å—Ç—å —Å–∏–º–≤–æ–ª—ã –Ω–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö –∏ unicode, —á—Ç–æ–±—ã —Å–±–∏—Ç—å —Å —Ç–æ–ª–∫—É.
- –°–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–æ—Å—Ç–æ—è—â–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑ —ç–º–æ–¥–∑–∏.

–ò—Å–∫–ª—é—á–µ–Ω–∏—è:
- –°–æ–æ–±—â–µ–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–æ–º–∞—à–Ω–∏–º–∏ –∂–∏–≤–æ—Ç–Ω—ã–º–∏ (—á–∞—Å—Ç–æ –æ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–∞—Ö)
- –ü—Ä–æ—Å—å–±—ã –æ –ø–æ–º–æ—â–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ–º–æ—â–∏ (—á–∞—Å—Ç–æ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–∏—Å–∫–æ–º –ø—Ä–æ–ø–∞–≤—à–∏—Ö –ª—é–¥–µ–π –∏–ª–∏ –≤–µ—â–µ–π, –ø–æ–¥–≤–æ–¥–æ–º –ª—é–¥–µ–π –∫—É–¥–∞-–ª–∏–±–æ)
- –°—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ã—á–Ω—ã–µ –≤–µ–±—Å–∞–π—Ç—ã, –Ω–µ —è–≤–ª—è—é—â–∏–µ—Å—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å–ª—É–≥–∞–º, —Ç–æ–≤–∞—Ä–∞–º, –∫—É—Ä—Å–∞–º –∏ —Ç.–ø.

–û—Ç–≤–µ—á–∞–π –¢–û–õ–¨–ö–û —Å–ª–µ–¥—É—é—â–∏–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏:
–µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —è–≤–ª—è–µ—Ç—Å—è —Å–ø–∞–º–æ–º: 1 
–µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–ø–∞–º–æ–º: 0

–ë–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞. –ë–µ–∑ –∫–∞–≤—ã—á–µ–∫. –ë–µ–∑ –æ—Ñ–æ–º–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ç–∫–æ–π. –ù–µ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
`
